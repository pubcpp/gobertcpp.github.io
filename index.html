<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="流媒体开发">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="流媒体开发">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="gobert">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>流媒体开发</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">流媒体开发</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">5</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">22</span></a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">8</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/gobertcpp" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/4a17b156.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="gobert">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="流媒体开发">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/4a17b156.html" class="post-title-link" itemprop="url">Hello World</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-02-13 21:26:14" itemprop="dateCreated datePublished" datetime="2022-02-13T21:26:14+08:00">2022-02-13</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/79666db.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="gobert">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="流媒体开发">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/79666db.html" class="post-title-link" itemprop="url">数据结构</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-06-13 17:14:43" itemprop="dateCreated datePublished" datetime="2019-06-13T17:14:43+08:00">2019-06-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-13 21:26:14" itemprop="dateModified" datetime="2022-02-13T21:26:14+08:00">2022-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C++</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/f9801b05.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="gobert">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="流媒体开发">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/f9801b05.html" class="post-title-link" itemprop="url">经典算法题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-06-11 10:24:41" itemprop="dateCreated datePublished" datetime="2019-06-11T10:24:41+08:00">2019-06-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-13 21:26:14" itemprop="dateModified" datetime="2022-02-13T21:26:14+08:00">2022-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C++</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="二叉树遍历"><a href="#二叉树遍历" class="headerlink" title="二叉树遍历"></a>二叉树遍历</h2><ul>
<li><p>前序遍历<br>  根结点 —&gt; 左子树 —&gt; 右子树</p>
</li>
<li><p>中序遍历<br>  左子树—&gt; 根结点 —&gt; 右子树</p>
</li>
<li><p>后序遍历<br>  左子树 —&gt; 右子树 —&gt; 根结点</p>
</li>
<li><p>层次遍历<br>  只需按层次遍历即可</p>
</li>
</ul>
<p>二叉树数据结构：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">TreeNode</span>&#123;</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line">    TreeNode* left;</span><br><span class="line">    TreeNode* right;</span><br><span class="line">    <span class="built_in">TreeNode</span>(<span class="type">int</span> x) : <span class="built_in">val</span>(x), <span class="built_in">left</span>(<span class="literal">NULL</span>), <span class="built_in">right</span>(<span class="literal">NULL</span>) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="前序遍历"><a href="#前序遍历" class="headerlink" title="前序遍历"></a>前序遍历</h3><ul>
<li>递归遍历</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">PreTraverse</span><span class="params">(TreeNode* root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; root-&gt;value;</span><br><span class="line">    <span class="built_in">PreOrder</span>(root-&gt;left);</span><br><span class="line">    <span class="built_in">PreOrder</span>(root-&gt;right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>非递归遍历</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">PreTraverse</span><span class="params">(TreeNode* root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    stack&lt;TreeNode*&gt; stack_list;</span><br><span class="line">    TreeNode* tmp_root = root;</span><br><span class="line">    <span class="keyword">while</span> (!tmp_root || !stack_list.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!tmp_root) &#123;</span><br><span class="line">            cout &lt;&lt; tmp_root-&gt;value &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">            stack_list.<span class="built_in">push</span>(tmp_root);</span><br><span class="line">            tmp_root = tmp_root-&gt;left;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            TreeNode node = stack_list.<span class="built_in">pop</span>();</span><br><span class="line">            tmp_root = node.right;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="中序遍历"><a href="#中序遍历" class="headerlink" title="中序遍历"></a>中序遍历</h3><ul>
<li>递归遍历</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">MiddleTraverse</span><span class="params">(TreeNode* root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">MiddleOrder</span>(root-&gt;left);</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; root-&gt;value;</span><br><span class="line">    <span class="built_in">MiddleOrder</span>(root-&gt;right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>非递归遍历</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">MiddleTraverse</span><span class="params">(TreeNode* root)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    stack&lt;TreeNode*&gt; stack_list;</span><br><span class="line">    TreeNode* tmp_root = root;</span><br><span class="line">    <span class="keyword">while</span>(!tmp_root || !stack_list.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!tmp_root) &#123;</span><br><span class="line">            stack.<span class="built_in">push</span>(tmp_root);</span><br><span class="line">            tmp_root = tmp_root-&gt;left;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            TreeNode *node = stack_list.<span class="built_in">pop</span>();</span><br><span class="line">            cout &lt;&lt; node-&gt;value &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">            tmp_root = tmp_root-&gt;right;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="后序遍历"><a href="#后序遍历" class="headerlink" title="后序遍历"></a>后序遍历</h3><ul>
<li>递归遍历</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">MiddleTraverse</span><span class="params">(TreeNode* root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">MiddleOrder</span>(root-&gt;left);</span><br><span class="line">    <span class="built_in">MiddleOrder</span>(root-&gt;right);</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; root-&gt;value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>非递归遍历</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">MiddleTraverse</span><span class="params">(TreeNode* root)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    stack&lt;TreeNode*&gt; stack_list;</span><br><span class="line">    TreeNode* tmp_root = root;</span><br><span class="line">    <span class="keyword">while</span>(!tmp_root || !stack_list.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!tmp_root) &#123;</span><br><span class="line">            stack.<span class="built_in">push</span>(tmp_root);</span><br><span class="line">            tmp_root = tmp_root-&gt;left;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            TreeNode *node = stack_list.<span class="built_in">pop</span>();</span><br><span class="line">            tmp_root = tmp_root-&gt;right;</span><br><span class="line">            cout &lt;&lt; node-&gt;value &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="广度优先-x2F-层次遍历"><a href="#广度优先-x2F-层次遍历" class="headerlink" title="广度优先&#x2F;层次遍历"></a>广度优先&#x2F;层次遍历</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     TreeNode *right;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int x) : val(x), left(NULL), right(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">levelOrder</span>(TreeNode* root) &#123;</span><br><span class="line">        vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; ret_vec;</span><br><span class="line">        </span><br><span class="line">        queue&lt;TreeNode*&gt; stack_node;</span><br><span class="line">        stack_node.<span class="built_in">push</span>(root);</span><br><span class="line">        <span class="keyword">while</span>(!stack_node.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> count = stack_node.<span class="built_in">size</span>();</span><br><span class="line">            vector&lt;<span class="type">int</span>&gt; tmp_vec;</span><br><span class="line">            <span class="keyword">while</span>(count--) &#123;</span><br><span class="line">                TreeNode* node = stack_node.<span class="built_in">front</span>();</span><br><span class="line">                stack_node.<span class="built_in">pop</span>();</span><br><span class="line">                tmp_vec.<span class="built_in">push_back</span>(node-&gt;val);</span><br><span class="line">                <span class="keyword">if</span>(node-&gt;left) &#123;</span><br><span class="line">                    stack_node.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(node-&gt;right) &#123;</span><br><span class="line">                    stack_node.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">                &#125;                  </span><br><span class="line">            &#125;   </span><br><span class="line">            ret_vec.<span class="built_in">push_back</span>(tmp_vec);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret_vec;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="深度优先遍历"><a href="#深度优先遍历" class="headerlink" title="深度优先遍历"></a>深度优先遍历</h2><p>递归遍历</p>
<h2 id="求二叉树最大宽度"><a href="#求二叉树最大宽度" class="headerlink" title="求二叉树最大宽度"></a>求二叉树最大宽度</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">widthOfBinaryTree</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        queue&lt;TreeNode*&gt; stack_node;</span><br><span class="line">        TreeNode* pNode = root;</span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">max_width</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line">        stack_node.<span class="built_in">push</span>(pNode);</span><br><span class="line">        <span class="keyword">while</span>(pNode) &#123;</span><br><span class="line">            <span class="type">size_t</span> count = stack_node.<span class="built_in">size</span>();</span><br><span class="line">            <span class="keyword">if</span> (count &gt; max_width) &#123;</span><br><span class="line">                max_width = count;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span>(count--) &#123;</span><br><span class="line">                TreeNode* node = stack_node.<span class="built_in">front</span>();</span><br><span class="line">                stack_node.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="keyword">if</span>(node-&gt;left)</span><br><span class="line">                    stack_node.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">                <span class="keyword">if</span>(node-&gt;right)</span><br><span class="line">                    stack_node.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> max_width;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="判断二叉树是否对称"><a href="#判断二叉树是否对称" class="headerlink" title="判断二叉树是否对称"></a>判断二叉树是否对称</h2><ul>
<li>递归判断</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">IsMirror</span><span class="params">(TreeNode* left, TreeNode* right)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!left &amp;&amp; !right) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!left || !right) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (left-&gt;val == right-&gt;val) </span><br><span class="line">                &amp;&amp; <span class="built_in">IsMirror</span>(left-&gt;left, right-&gt;right) </span><br><span class="line">                &amp;&amp; <span class="built_in">IsMirror</span>(left-&gt;right, right-&gt;left); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">IsMirror</span><span class="params">(TreeNode* root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">IsMirror</span>(root, root);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>非递归&#x2F;迭代法判断</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">IsMirror</span><span class="params">(TreeNode* root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    queue&lt;TreeNode*&gt; queue_node;</span><br><span class="line">    queue_node.<span class="built_in">push</span>(root);</span><br><span class="line">    queue_node.<span class="built_in">push</span>(root);</span><br><span class="line">    <span class="keyword">while</span>(!queue_node.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        TreeNode* t1 = queue_node.<span class="built_in">front</span>();</span><br><span class="line">        queue_node.<span class="built_in">pop</span>();</span><br><span class="line">        TreeNode* t2 = queue_node.<span class="built_in">front</span>();</span><br><span class="line">        queue_node.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span>(!t1 &amp;&amp; !t2) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!t1 || !t2) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        queue_node.<span class="built_in">push</span>(t1.left);</span><br><span class="line">        queue_node.<span class="built_in">push</span>(t2.right);</span><br><span class="line">        queue_node.<span class="built_in">push</span>(t1.right);</span><br><span class="line">        queue_node.<span class="built_in">push</span>(t2.left);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="大数相乘"><a href="#大数相乘" class="headerlink" title="大数相乘"></a>大数相乘</h2><p>是指那些相乘结果或是乘数本身用long long类型都会溢出的数字，通常这些数字都通过string类型进行表示，借助于可动态调整大小的数据结构（vector,string,deque）模拟实现数字的乘法操作。对于普通的乘法，我们知道m位数和n位数相乘，最后的结果位数在区间内[m+n-1,m+n]。例如34*56，我们通常这么计算：<br>将3，4分别于6相乘，记录低位的进位，然后将3，4对5进行相同的操作，知道第二个乘数的最高位乘完，算法结束。<br>所以我们可以保存每个位数的相乘结果，最后统一进位转换。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;sstream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">std::string <span class="title">BigNumMultiply</span><span class="params">(std::string s1, std::string s2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//记录最终结果</span></span><br><span class="line">    std::string res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="comment">//使用deque是因为出现进位时可以在队列前插入数据，效率比vector高，大小设为最小</span></span><br><span class="line">    <span class="function">std::deque&lt;<span class="type">int</span>&gt; <span class="title">vec</span><span class="params">(s1.size() + s2.size() - <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; s1.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; s2.<span class="built_in">size</span>(); ++j) &#123;</span><br><span class="line">            vec[i + j] += (s1[i] - <span class="string">&#x27;0&#x27;</span>)*(s2[j] - <span class="string">&#x27;0&#x27;</span>);<span class="comment">//记录相乘结果</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 进位处理</span></span><br><span class="line">    <span class="type">int</span> addflag = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 倒序遍历，是因为最左边的值为最高位，最右边的值在最低位，进位运算要从低位开始</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = vec.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">        <span class="type">int</span> temp = vec[i] + addflag;<span class="comment">//当前值加上进位值</span></span><br><span class="line">        vec[i] = temp % <span class="number">10</span>;<span class="comment">//当前值</span></span><br><span class="line">        addflag = temp / <span class="number">10</span>;<span class="comment">//进位值</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//如果有进位，将进位加到队列头部</span></span><br><span class="line">    <span class="keyword">while</span> (addflag != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="type">int</span> t = addflag % <span class="number">10</span>;</span><br><span class="line">        vec.<span class="built_in">push_front</span>(t);</span><br><span class="line">        addflag /= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 转换为字符串</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> c : vec) &#123;</span><br><span class="line">        std::ostringstream ss;</span><br><span class="line">        ss &lt;&lt; c;</span><br><span class="line">        res = res + ss.<span class="built_in">str</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="反转链表"><a href="#反转链表" class="headerlink" title="反转链表"></a>反转链表</h2><p>反转一个单链表。</p>
<p>解决方案</p>
<h3 id="迭代"><a href="#迭代" class="headerlink" title="迭代"></a>迭代</h3><blockquote>
<p>假设存在链表 1 → 2 → 3 → Ø，我们想要把它改成 Ø ← 1 ← 2 ← 3。</p>
</blockquote>
<p>在遍历列表时，将当前节点的 next 指针改为指向前一个元素。由于节点没有引用其上一个节点，因此必须事先存储其前一个元素。在更改引用之前，还需要另一个指针来存储下一个节点。不要忘记在最后返回新的头引用！</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ListNode* <span class="title">ReverseList</span><span class="params">(ListNode* root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root || !root-&gt;next) &#123;</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">    ListNode* prev = <span class="literal">NULL</span>;</span><br><span class="line">    ListNode* cur = root;</span><br><span class="line">    <span class="keyword">while</span> (cur) &#123;</span><br><span class="line">        ListNode* tmp = cur-&gt;next;</span><br><span class="line">        cur-&gt;next = prev;</span><br><span class="line">        prev = cur;</span><br><span class="line">        cur = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> prev;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>复杂度分析</p>
<ul>
<li><p>时间复杂度：O(n)O(n) 。 假设 nn 是列表的长度，时间复杂度是 O(n)O(n)。</p>
</li>
<li><p>空间复杂度：O(1)O(1) 。</p>
</li>
</ul>
<h3 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h3><p>递归版本稍微复杂一些，其关键在于反向工作。假设列表的其余部分已经被反转，现在我该如何反转它前面的部分？假设列表为：n1 → … → nk-1 → nk → nk+1 → … → nm → Ø</p>
<p>若从节点 nk+1 到 nm 已经被反转，而我们正处于 nk。</p>
<blockquote>
<p>n1 → … → nk-1 → nk → nk+1 ← … ← nm</p>
</blockquote>
<p>我们希望 nk+1 的下一个节点指向 nk。</p>
<p>所以，</p>
<blockquote>
<p>nk.next.next &#x3D; nk;</p>
</blockquote>
<p>要小心的是 n1 的下一个必须指向 Ø 。如果你忽略了这一点，你的链表中可能会产生循环。如果使用大小为 2 的链表测试代码，则可能会捕获此错误。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ListNode* <span class="title">ReverseList</span><span class="params">(ListNode* root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root || !root-&gt;next)</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    ListNode* tmp_node = <span class="built_in">reverseList</span>(root-&gt;next);</span><br><span class="line">    root-&gt;next-&gt;next = root;</span><br><span class="line">    root-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> tmp_node;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>复杂度分析</p>
<ul>
<li><p>时间复杂度：O(n)O(n) 。 假设 nn 是列表的长度，那么时间复杂度为 O(n)O(n)。</p>
</li>
<li><p>空间复杂度：O(n)O(n) 。 由于使用递归，将会使用隐式栈空间。递归深度可能会达到 nn 层。</p>
</li>
</ul>
<h2 id="二叉树转换为双向链表"><a href="#二叉树转换为双向链表" class="headerlink" title="二叉树转换为双向链表"></a>二叉树转换为双向链表</h2><p>题目：输入一棵二叉搜索树（二叉查找树），将该二叉搜索树转换成一个排序的双向链表。要求不能创建任何新的结点，只能调整树中结点指针的指向。</p>
<p>思路： 这道题目关键在于不能创建新的节点，如不然，我们可以直接将二叉排序树中序遍历保存到一个数组中，而后再建立一个双性链表，将数据保存到双向链表里。<br>    这里不能创建新节点，我们只能改变节点的指向左右子树的节点，让其变为指向二叉链表中的前后节点，很明显这里同样用的是中序遍历，因此这道题目依然是中序遍历的变种，中序递归构造实现即可，每次递归都保存一个指向已构造好的双向链表的尾节点的指针，将其与下一个节点连接起来。</p>
<p>代码实现（递归）：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">BSTNode</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> data;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">BSTNode</span> *left;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">BSTNode</span> *right;</span><br><span class="line">&#125;BSTNode,*BSTree;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">根据题目要求的格式创建二叉排序树</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CreateBST</span><span class="params">(BSTree *pRoot)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> data;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;data);</span><br><span class="line">	<span class="keyword">if</span>(data == <span class="number">0</span>)</span><br><span class="line">		pRoot = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		*pRoot = (BSTree)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(BSTNode));</span><br><span class="line">		<span class="keyword">if</span>(*pRoot == <span class="literal">NULL</span>)</span><br><span class="line">			<span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">		(*pRoot)-&gt;data = data;</span><br><span class="line">		(*pRoot)-&gt;left = <span class="literal">NULL</span>;</span><br><span class="line">		(*pRoot)-&gt;right = <span class="literal">NULL</span>;</span><br><span class="line">		<span class="built_in">CreateBST</span>(&amp;((*pRoot)-&gt;left));</span><br><span class="line">		<span class="built_in">CreateBST</span>(&amp;((*pRoot)-&gt;right));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">采用中序遍历的方式将二叉树转化为双向链表，</span></span><br><span class="line"><span class="comment">*pLas指向双向链表的最后一个节点</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ConvertNode</span><span class="params">(BSTree pRoot,BSTree *pLast)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(pRoot == <span class="literal">NULL</span>)</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//先转化左子树</span></span><br><span class="line">	<span class="keyword">if</span>(pRoot-&gt;left != <span class="literal">NULL</span>)</span><br><span class="line">		<span class="built_in">ConvertNode</span>(pRoot-&gt;left,pLast);</span><br><span class="line"> </span><br><span class="line">	<span class="comment">//将双向链表的最后一个节点与根节点连接在一起</span></span><br><span class="line">	pRoot-&gt;left = *pLast;</span><br><span class="line">	<span class="keyword">if</span>(*pLast != <span class="literal">NULL</span>)</span><br><span class="line">		(*pLast)-&gt;right = pRoot;</span><br><span class="line">	*pLast = pRoot;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">//转换右子树</span></span><br><span class="line">	<span class="keyword">if</span>(pRoot-&gt;right != <span class="literal">NULL</span>)</span><br><span class="line">		<span class="built_in">ConvertNode</span>(pRoot-&gt;right,pLast);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">返回双向链表的头结点</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function">BSTree <span class="title">Convert</span><span class="params">(BSTree pRoot)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(pRoot == <span class="literal">NULL</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">	<span class="keyword">if</span>(pRoot-&gt;left==<span class="literal">NULL</span> &amp;&amp; pRoot-&gt;right==<span class="literal">NULL</span>)</span><br><span class="line">		<span class="keyword">return</span> pRoot;</span><br><span class="line"> </span><br><span class="line">	BSTree pLast = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="built_in">ConvertNode</span>(pRoot,&amp;pLast);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//依次从 last 返回 first 头结点</span></span><br><span class="line">	BSTree pHead = pLast;</span><br><span class="line">	<span class="keyword">while</span>(pHead-&gt;left != <span class="literal">NULL</span>)</span><br><span class="line">		pHead = pHead-&gt;left;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">return</span> pHead;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n) != EOF)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">int</span> i;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			BSTree pRoot = <span class="literal">NULL</span>;</span><br><span class="line">			<span class="built_in">CreateBST</span>(&amp;pRoot);</span><br><span class="line">			BSTree pHead = <span class="built_in">Convert</span>(pRoot);</span><br><span class="line">			<span class="keyword">while</span>(pHead != <span class="literal">NULL</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,pHead-&gt;data);</span><br><span class="line">				pHead = pHead-&gt;right;</span><br><span class="line">			&#125;</span><br><span class="line"> </span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">			<span class="built_in">free</span>(pRoot);</span><br><span class="line">			pRoot = <span class="literal">NULL</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="反序链表求和"><a href="#反序链表求和" class="headerlink" title="反序链表求和"></a>反序链表求和</h2><p>Input: (2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4)<br>Output: 7 -&gt; 0 -&gt; 8</p>
<p>思路：<br>首先要理解题目，输入的两个链表都是反序存储的。也就是链表首位代表数字的个位，第二位代表数字百位。接下来就和一般求和的题目一样了，维护当前求和结果和进位即可。注意最后要判断，是否还有进位，如果有，还需要再生成一位。</p>
<p>代码实现：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ListNode</span> &#123;</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line">    ListNode* next;</span><br><span class="line">    <span class="built_in">ListNode</span>(<span class="type">int</span> vul) &#123;</span><br><span class="line">        value = vul;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 注意返回值需要手动释放</span></span><br><span class="line"><span class="function">ListNode* <span class="title">AddTwoListNumbers</span><span class="params">(ListNode* list1, ListNode* list2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ListNode* l1 = list1;</span><br><span class="line">    ListNode* l2 = list2;</span><br><span class="line">    ListNode* dest = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">    ListNode* tmp_dest = dest;</span><br><span class="line">    <span class="type">int</span> carry = <span class="number">0</span>; <span class="comment">// 记录进位</span></span><br><span class="line">    <span class="keyword">while</span>(l1 || l2) &#123;</span><br><span class="line">        <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (l1) &#123;</span><br><span class="line">            sum += l1-&gt;value;</span><br><span class="line">            l1 = l1-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (l2) &#123;</span><br><span class="line">            sum += l2-&gt;value;</span><br><span class="line">            l2 = l2-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        tmp_dest-&gt;value = carry + sum % <span class="number">10</span>;</span><br><span class="line">        tmp_dest-&gt;next = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">        tmp_dest = tmp_dest-&gt;next;</span><br><span class="line">        carry = sum / <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (carry &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        tmp_dest-&gt;next-&gt;value = carry;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>时间复杂度：O(n)</p>
<h2 id="查找字符串中字典序最大的序列"><a href="#查找字符串中字典序最大的序列" class="headerlink" title="查找字符串中字典序最大的序列"></a>查找字符串中字典序最大的序列</h2><p>题目描述：给一个字符串，得到它字典序最大的子序列，即：删除一些字符，使得剩下的字符构成的字符串字典序是最大的</p>
<p>代码实现：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">string <span class="title">GetMaxString</span><span class="params">(<span class="type">const</span> string&amp; src_str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (src_str.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    stack&lt;<span class="type">char</span>&gt; dest;</span><br><span class="line">    string dest_str;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; src_str.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dest.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            dest.<span class="built_in">push</span>(src_str.<span class="built_in">at</span>(i));</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (!dest.<span class="built_in">empty</span>() &amp;&amp; src_str[i] &gt; dest.<span class="built_in">top</span>()) &#123;</span><br><span class="line">            dest.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        dest.<span class="built_in">push</span>(src_str.<span class="built_in">at</span>(i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (!dest.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        dest_str.<span class="built_in">insert</span>(dest_str.<span class="built_in">begin</span>(), dest.<span class="built_in">top</span>());</span><br><span class="line">        dest.<span class="built_in">pop</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dest_str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/e828fac3.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="gobert">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="流媒体开发">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/e828fac3.html" class="post-title-link" itemprop="url">C++算法大全</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-05-28 09:40:18" itemprop="dateCreated datePublished" datetime="2019-05-28T09:40:18+08:00">2019-05-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-13 21:26:14" itemprop="dateModified" datetime="2022-02-13T21:26:14+08:00">2022-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C++</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>以内内容为互联网收集，非原创。</p>
</blockquote>
<h2 id="算法分类"><a href="#算法分类" class="headerlink" title="算法分类"></a>算法分类</h2><p>常见的排序算法分为两类：</p>
<ul>
<li><p><strong>比较类排序：</strong>通过比较来决定元素间的相对次序，由于其时间复杂度不能突破O(nlogn)，因此也称为非线性时间比较类排序。</p>
</li>
<li><p><strong>非比较类排序：</strong>不通过比较来决定元素间的相对次序，它可以突破基于比较排序的时间下界，以线性时间运行，因此也称为线性时间非比较类排序。</p>
</li>
</ul>
<p><img src="/images/algorithm/%E7%AE%97%E6%B3%95%E5%88%86%E7%B1%BB.png" alt="算法分类"></p>
<h2 id="算法复杂度"><a href="#算法复杂度" class="headerlink" title="算法复杂度"></a>算法复杂度</h2><p><img src="/images/algorithm/%E7%AE%97%E6%B3%95%E5%A4%8D%E6%9D%82%E5%BA%A6.png" alt="算法复杂度"></p>
<ul>
<li><strong>时间复杂度：</strong>对排序数据的总的操作次数。反映当n变化时，操作次数呈现什么规律。</li>
<li><strong>空间复杂度：</strong>是指算法在计算机内执行时所需存储空间的度量，它也是数据规模n的函数。</li>
</ul>
<h2 id="经典排序"><a href="#经典排序" class="headerlink" title="经典排序"></a>经典排序</h2><h3 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h3><p>冒泡排序是一种简单的排序算法。它重复地走访过要排序的数列，一次比较两个元素，如果它们的顺序错误就把它们交换过来。走访数列的工作是重复地进行直到没有再需要交换，也就是说该数列已经排序完成。这个算法的名字由来是因为越小的元素会经由交换慢慢“浮”到数列的顶端。 </p>
<h4 id="算法描述"><a href="#算法描述" class="headerlink" title="算法描述"></a>算法描述</h4><ul>
<li>比较相邻的元素。如果第一个比第二个大，就交换它们两个；</li>
<li>对每一对相邻元素作同样的工作，从开始第一对到结尾的最后一对，这样在最后的元素应该会是最大的数；</li>
<li>针对所有的元素重复以上的步骤，除了最后一个；</li>
<li>重复步骤1~3，直到排序完成。</li>
</ul>
<h4 id="动图演示"><a href="#动图演示" class="headerlink" title="动图演示"></a>动图演示</h4><p><img src="/images/algorithm/%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F.gif" alt="插入排序"></p>
<h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">BubbleSort</span><span class="params">(<span class="type">int</span>* src, <span class="type">int</span> count)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!src || count &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="built_in">i</span>(<span class="number">0</span>); i &lt; count; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="built_in">j</span>(<span class="number">0</span>); j &lt; count - i - <span class="number">1</span>; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (src[j] &gt; src[j + <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="type">int</span> tmp = src[j + <span class="number">1</span>];</span><br><span class="line">                src[j + <span class="number">1</span>] = src[j];</span><br><span class="line">                src[j] = tmp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="选择排序（Selection-Sort）"><a href="#选择排序（Selection-Sort）" class="headerlink" title="选择排序（Selection Sort）"></a>选择排序（Selection Sort）</h3><p>选择排序(Selection-sort)是一种简单直观的排序算法。它的工作原理：首先在未排序序列中找到最小（大）元素，存放到排序序列的起始位置，然后，再从剩余未排序元素中继续寻找最小（大）元素，然后放到已排序序列的末尾。以此类推，直到所有元素均排序完毕。 </p>
<h4 id="算法描述-1"><a href="#算法描述-1" class="headerlink" title="算法描述"></a>算法描述</h4><p>n个记录的直接选择排序可经过n-1趟直接选择排序得到有序结果。具体算法描述如下：</p>
<ul>
<li>初始状态：无序区为R[1..n]，有序区为空；</li>
<li>第i趟排序(i&#x3D;1,2,3…n-1)开始时，当前有序区和无序区分别为R[1..i-1]和R(i..n）。该趟排序从当前无序区中-选出关键字最小的记录 R[k]，将它与无序区的第1个记录R交换，使R[1..i]和R[i+1..n)分- 别变为记录个数增加1个的新有序区和记录个数减少1个的新无序区；</li>
<li>n-1趟结束，数组有序化了。</li>
</ul>
<h4 id="动图演示-1"><a href="#动图演示-1" class="headerlink" title="动图演示"></a>动图演示</h4><p><img src="/images/algorithm/%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F.gif" alt="插入排序"></p>
<h4 id="代码实现-1"><a href="#代码实现-1" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">SelectSort</span><span class="params">(<span class="type">int</span>* src, <span class="type">int</span> count)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!src || count &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="built_in">i</span>(<span class="number">0</span>); i &lt; count; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> min_num = i;</span><br><span class="line">        <span class="type">int</span> min_value = src[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="built_in">j</span>(i + <span class="number">1</span>); j &lt; count; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (src[j] &lt; min_value) &#123;</span><br><span class="line">                min_num = j;</span><br><span class="line">                min_value = src[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (min_num != i) &#123;</span><br><span class="line">            <span class="type">int</span> tmp = src[min_num];</span><br><span class="line">            src[min_num] = src[i];</span><br><span class="line">            src[i] = tmp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h3><p>插入排序（Insertion-Sort）的算法描述是一种简单直观的排序算法。它的工作原理是通过构建有序序列，对于未排序数据，在已排序序列中从后向前扫描，找到相应位置并插入。</p>
<h4 id="算法描述-2"><a href="#算法描述-2" class="headerlink" title="算法描述"></a>算法描述</h4><p>一般来说，插入排序都采用in-place在数组上实现。具体算法描述如下：</p>
<ul>
<li>从第一个元素开始，该元素可以认为已经被排序；</li>
<li>取出下一个元素，在已经排序的元素序列中从后向前扫描；</li>
<li>如果该元素（已排序）大于新元素，将该元素移到下一位置；</li>
<li>重复步骤3，直到找到已排序的元素小于或者等于新元素的位置；</li>
<li>将新元素插入到该位置后；</li>
<li>重复步骤2~5。</li>
</ul>
<h4 id="动图演示-2"><a href="#动图演示-2" class="headerlink" title="动图演示"></a>动图演示</h4><p><img src="/images/algorithm/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F.gif" alt="插入排序"></p>
<h4 id="代码实现-2"><a href="#代码实现-2" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">InsertSort</span><span class="params">(<span class="type">int</span> *src, <span class="type">int</span> count)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!src || count &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">pre_index</span><span class="params">(<span class="number">0</span>)</span>, <span class="title function_">cur_value</span><span class="params">(<span class="number">0</span>)</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i(<span class="number">1</span>); i &lt; count; ++i) &#123;</span><br><span class="line">        pre_index = i - <span class="number">1</span>;</span><br><span class="line">        cur_value = src[i];</span><br><span class="line">        <span class="keyword">while</span> (pre_index &gt;= <span class="number">0</span> &amp;&amp; src[pre_index] &gt; cur_value) &#123;</span><br><span class="line">            src[pre_index + <span class="number">1</span>] = src[pre_index];</span><br><span class="line">            --pre_index;</span><br><span class="line">        &#125;</span><br><span class="line">        src[pre_index + <span class="number">1</span>] = cur_value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="希尔排序（Insertion-Sort）"><a href="#希尔排序（Insertion-Sort）" class="headerlink" title="希尔排序（Insertion Sort）"></a>希尔排序（Insertion Sort）</h3><p>1959年Shell发明，第一个突破O(n2)的排序算法，是简单插入排序的改进版。它与插入排序的不同之处在于，它会优先比较距离较远的元素。希尔排序又叫缩小增量排序。</p>
<h4 id="算法描述-3"><a href="#算法描述-3" class="headerlink" title="算法描述"></a>算法描述</h4><p>先将整个待排序的记录序列分割成为若干子序列分别进行直接插入排序，具体算法描述：</p>
<ul>
<li>选择一个增量序列t1，t2，…，tk，其中ti&gt;tj，tk&#x3D;1；</li>
<li>按增量序列个数k，对序列进行k 趟排序；</li>
<li>每趟排序，根据对应的增量ti，将待排序列分割成若干长度为m 的子序列，分别对各子表进行直接插入排序。仅增量因子为1 时，整个序列作为一个表来处理，表长度即为整个序列的长度。</li>
</ul>
<h4 id="动图演示-3"><a href="#动图演示-3" class="headerlink" title="动图演示"></a>动图演示</h4><p><img src="/images/algorithm/%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F.gif" alt="插入排序"></p>
<h4 id="代码实现-3"><a href="#代码实现-3" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">ShellSort</span><span class="params">(<span class="type">int</span> *src, <span class="type">int</span> count)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i, j, k, group;</span><br><span class="line">    <span class="keyword">for</span> (group = count / <span class="number">2</span>; group &gt; <span class="number">0</span>; group /= <span class="number">2</span>)<span class="comment">//增量序列为n/2,n/4....直到1</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; group; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (j = i + group; j &lt; count; j += group) &#123;</span><br><span class="line">                <span class="comment">//对每个分组进行插入排序</span></span><br><span class="line">                <span class="keyword">if</span> (src[j - group] &gt; src[j]) &#123;</span><br><span class="line">                    <span class="type">int</span> temp = src[j];</span><br><span class="line">                    k = j - group;</span><br><span class="line">                    <span class="keyword">while</span> (k &gt;= <span class="number">0</span> &amp;&amp; src[k] &gt; temp) &#123;</span><br><span class="line">                        src[k + group] = src[k];</span><br><span class="line">                        k -= group;</span><br><span class="line">                    &#125;</span><br><span class="line">                    src[k + group] = temp;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="归并排序（Merge-Sort）"><a href="#归并排序（Merge-Sort）" class="headerlink" title="归并排序（Merge Sort）"></a>归并排序（Merge Sort）</h3><p>归并排序是建立在归并操作上的一种有效的排序算法。该算法是采用分治法（Divide and Conquer）的一个非常典型的应用。将已有序的子序列合并，得到完全有序的序列；即先使每个子序列有序，再使子序列段间有序。若将两个有序表合并成一个有序表，称为2-路归并。 </p>
<h4 id="算法描述-4"><a href="#算法描述-4" class="headerlink" title="算法描述"></a>算法描述</h4><p>把长度为n的输入序列分成两个长度为n&#x2F;2的子序列；<br>对这两个子序列分别采用归并排序；<br>将两个排序好的子序列合并成一个最终的排序序列。</p>
<h4 id="动图演示-4"><a href="#动图演示-4" class="headerlink" title="动图演示"></a>动图演示</h4><p><img src="/images/algorithm/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F.gif" alt="插入排序"></p>
<h4 id="代码实现-4"><a href="#代码实现-4" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Merge</span><span class="params">(<span class="type">int</span>* src_left, <span class="type">int</span> left_count, <span class="type">int</span>* src_right, <span class="type">int</span> right_count, <span class="type">int</span> *dest)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">left_index</span><span class="params">(<span class="number">0</span>)</span>, <span class="title">right_index</span><span class="params">(<span class="number">0</span>)</span>, <span class="title">index</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">while</span> (left_index &lt; left_count &amp;&amp; right_index &lt; right_count) &#123;</span><br><span class="line">        <span class="keyword">if</span> (src_left[left_index] &lt; src_right[right_index]) &#123;</span><br><span class="line">            dest[index] = src_left[left_index];</span><br><span class="line">            ++left_index;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            dest[index] = src_right[right_index];</span><br><span class="line">            ++right_index;</span><br><span class="line">        &#125;</span><br><span class="line">        ++index;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (left_index &lt; left_count) &#123;</span><br><span class="line">        dest[index++] = src_left[left_index++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (right_index &lt; right_count) &#123;</span><br><span class="line">        dest[index++] = src_right[right_index++];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MergeSort</span><span class="params">(<span class="type">int</span>* src, <span class="type">int</span> count)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!src || count &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 首先拆分成 2 个数组</span></span><br><span class="line">    <span class="type">int</span> middle = count / <span class="number">2</span>;</span><br><span class="line">    <span class="type">int</span> left_count = middle;</span><br><span class="line">    <span class="type">int</span> right_count = count - middle;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> *src_left = <span class="keyword">new</span> <span class="type">int</span>[left_count];</span><br><span class="line">    <span class="type">int</span> *src_right = <span class="keyword">new</span> <span class="type">int</span>[right_count];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="built_in">i</span>(<span class="number">0</span>); i &lt; left_count; ++i) &#123;</span><br><span class="line">        src_left[i] = src[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="built_in">i</span>(<span class="number">0</span>); i &lt; right_count; ++i) &#123;</span><br><span class="line">        src_right[i] = src[i + middle];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 递归 归并排序</span></span><br><span class="line">    <span class="built_in">MergeSort</span>(src_left, left_count);</span><br><span class="line">    <span class="built_in">MergeSort</span>(src_right, right_count);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Merge</span>(src_left, left_count, src_right, right_count, src);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">delete</span>[]src_left;</span><br><span class="line">    <span class="keyword">delete</span>[]src_right;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="算法分析"><a href="#算法分析" class="headerlink" title="算法分析"></a>算法分析</h4><p>归并排序是一种稳定的排序方法。和选择排序一样，归并排序的性能不受输入数据的影响，但表现比选择排序好的多，因为始终都是O(nlogn）的时间复杂度。代价是需要额外的内存空间。</p>
<h3 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h3><p>快速排序的基本思想：通过一趟排序将待排记录分隔成独立的两部分，其中一部分记录的关键字均比另一部分的关键字小，则可分别对这两部分记录继续进行排序，以达到整个序列有序。</p>
<h4 id="算法描述-5"><a href="#算法描述-5" class="headerlink" title="算法描述"></a>算法描述</h4><ul>
<li>先从数列中取出一个数作为key值；</li>
<li>将比这个数小的数全部放在它的左边，大于或等于它的数全部放在它的右边；</li>
<li>对左右两个小数列重复第二步，直至各区间只有1个数；</li>
</ul>
<h4 id="动图演示-5"><a href="#动图演示-5" class="headerlink" title="动图演示"></a>动图演示</h4><p><img src="/images/algorithm/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F.gif" alt="快速排序"></p>
<h4 id="代码实现-5"><a href="#代码实现-5" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">QuikSort</span><span class="params">(<span class="type">int</span>* src, <span class="type">int</span> left, <span class="type">int</span> right)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!src || left &gt;= right) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">i</span><span class="params">(left)</span>, <span class="title">j</span><span class="params">(right)</span></span>;</span><br><span class="line">    <span class="type">int</span> key = src[left];</span><br><span class="line">    <span class="keyword">while</span> (i &lt; j) &#123;</span><br><span class="line">        <span class="comment">// 从右至左查找第一个小于 key 的值</span></span><br><span class="line">        <span class="keyword">while</span> (i &lt; j &amp;&amp; src[j] &gt;= key) &#123;</span><br><span class="line">            --j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (i &lt; j) &#123;</span><br><span class="line">            src[i] = src[j];</span><br><span class="line">            ++i;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 从左至右查找第一个大于 key 的值</span></span><br><span class="line">        <span class="keyword">while</span> (i &lt; j &amp;&amp; src[i] &lt; key) &#123;</span><br><span class="line">            ++i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (i &lt; j) &#123;</span><br><span class="line">            src[j] = src[i];</span><br><span class="line">            --j;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    src[i] = key;</span><br><span class="line">    <span class="built_in">QuikSort</span>(src, left, i - <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">QuikSort</span>(src, i + <span class="number">1</span>, right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="堆排序"><a href="#堆排序" class="headerlink" title="堆排序"></a>堆排序</h3><p>堆排序（Heapsort）是指利用堆这种数据结构所设计的一种排序算法。堆积是一个近似完全二叉树的结构，并同时满足堆积的性质：即子结点的键值或索引总是小于（或者大于）它的父节点。</p>
<h4 id="算法描述-6"><a href="#算法描述-6" class="headerlink" title="算法描述"></a>算法描述</h4><p>将初始待排序关键字序列(R1,R2….Rn)构建成大顶堆，此堆为初始的无序区；<br>将堆顶元素R[1]与最后一个元素R[n]交换，此时得到新的无序区(R1,R2,……Rn-1)和新的有序区(Rn),且满足R[1,2…n-1]&lt;&#x3D;R[n]；<br>由于交换后新的堆顶R[1]可能违反堆的性质，因此需要对当前无序区(R1,R2,……Rn-1)调整为新堆，然后再次将R[1]与无序区最后一个元素交换，得到新的无序区(R1,R2….Rn-2)和新的有序区(Rn-1,Rn)。不断重复此过程直到有序区的元素个数为n-1，则整个排序过程完成。</p>
<h4 id="动图演示-6"><a href="#动图演示-6" class="headerlink" title="动图演示"></a>动图演示</h4><p><img src="/images/algorithm/%E5%A0%86%E6%8E%92%E5%BA%8F.gif" alt="堆排序"></p>
<h4 id="代码实现-6"><a href="#代码实现-6" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构建大顶堆</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">HeapBuild</span><span class="params">(<span class="type">int</span>* src, <span class="type">int</span> root, <span class="type">int</span> count)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!src) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> left = root * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (left &lt; count) &#123;</span><br><span class="line">        <span class="type">int</span> max_num = left; <span class="comment">// 先默认左节点为最大值的下标</span></span><br><span class="line">        <span class="type">int</span> right = left + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (right &lt; count) &#123;</span><br><span class="line">            <span class="keyword">if</span> (src[right] &gt; src[max_num]) &#123;</span><br><span class="line">                max_num = right;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (src[root] &lt; src[max_num]) &#123;</span><br><span class="line">            <span class="comment">// 交换比父节点大的最大子节点</span></span><br><span class="line">            <span class="type">int</span> tmp_val = src[root];</span><br><span class="line">            src[root] = src[max_num];</span><br><span class="line">            src[max_num] = tmp_val;</span><br><span class="line">            <span class="comment">// 从此次最大子节点的那个位置开始递归建堆</span></span><br><span class="line">            <span class="built_in">HeapBuild</span>(src, max_num, count);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">HeapSort</span><span class="params">(<span class="type">int</span>* src, <span class="type">int</span> count)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!src || count &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 从最后一个非叶子节点的父节点开始建堆，这样才能保证顺序</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="built_in">i</span>(count / <span class="number">2</span>); i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">        <span class="built_in">HeapBuild</span>(src, i, count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将已经建好的大顶堆进行排序，1、将最前和最后两个元素对调；2、重新建堆；3、重复第一步</span></span><br><span class="line">    <span class="comment">// j 表示数组此时的长度，因为 count 长度已经建过了</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="built_in">j</span>(count - <span class="number">1</span>); j &gt; <span class="number">0</span>; --j) &#123;</span><br><span class="line">        <span class="comment">// 交换首尾元素，将最大值交换到数组的最后位置</span></span><br><span class="line">        <span class="type">int</span> tmp_val = src[<span class="number">0</span>];</span><br><span class="line">        src[<span class="number">0</span>] = src[j];</span><br><span class="line">        src[j] = tmp_val;</span><br><span class="line">        <span class="comment">// 去除最后元素重新建堆</span></span><br><span class="line">        <span class="built_in">HeapBuild</span>(src, <span class="number">0</span>, j);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="计数排序"><a href="#计数排序" class="headerlink" title="计数排序"></a>计数排序</h3><p>计数排序不是基于比较的排序算法，其核心在于将输入的数据值转化为键存储在额外开辟的数组空间中。 作为一种线性时间复杂度的排序，计数排序要求输入的数据必须是有确定范围的整数。</p>
<h4 id="算法描述-7"><a href="#算法描述-7" class="headerlink" title="算法描述"></a>算法描述</h4><ul>
<li>找出待排序的数组中最大和最小的元素；</li>
<li>统计数组中每个值为i的元素出现的次数，存入数组C的第i项；</li>
<li>对所有的计数累加（从C中的第一个元素开始，每一项和前一项相加）；</li>
<li>反向填充目标数组：将每个元素i放在新数组的第C(i)项，每放一个元素就将C(i)减去1。</li>
</ul>
<h4 id="动图演示-7"><a href="#动图演示-7" class="headerlink" title="动图演示"></a>动图演示</h4><p><img src="/images/algorithm/%E8%AE%A1%E6%95%B0%E6%8E%92%E5%BA%8F.gif" alt="计数排序"></p>
<h4 id="代码实现-7"><a href="#代码实现-7" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">CountSort</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; src_vec, <span class="type">int</span> max_val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (src_vec.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 新建一个数组</span></span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">count</span><span class="params">(max_val + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">tmp</span><span class="params">(src_vec)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> val : src_vec) &#123;</span><br><span class="line">        count[val]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="built_in">i</span>(<span class="number">1</span>); i &lt;= max_val; ++i) &#123;</span><br><span class="line">        count[i] += count[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = src_vec.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">        src_vec[count[tmp[i]] - <span class="number">1</span>] = tmp[i];</span><br><span class="line">        count[tmp[i]]--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="算法分析-1"><a href="#算法分析-1" class="headerlink" title="算法分析"></a>算法分析</h4><p>计数排序是一个稳定的排序算法。当输入的元素是 n 个 0到 k 之间的整数时，时间复杂度是O(n+k)，空间复杂度也是O(n+k)，其排序速度快于任何比较排序算法。当k不是很大并且序列比较集中时，计数排序是一个很有效的排序算法。</p>
<h3 id="桶排序"><a href="#桶排序" class="headerlink" title="桶排序"></a>桶排序</h3><p>桶排序是计数排序的升级版。它利用了函数的映射关系，高效与否的关键就在于这个映射函数的确定。桶排序 (Bucket sort)的工作的原理：假设输入数据服从均匀分布，将数据分到有限数量的桶里，每个桶再分别排序（有可能再使用别的排序算法或是以递归方式继续使用桶排序进行排）。</p>
<h4 id="算法描述-8"><a href="#算法描述-8" class="headerlink" title="算法描述"></a>算法描述</h4><ul>
<li>设置一个定量的数组当作空桶；</li>
<li>遍历输入数据，并且把数据一个一个放到对应的桶里去；</li>
<li>对每个不是空的桶进行排序；</li>
<li>从不是空的桶里把排好序的数据拼接起来。</li>
</ul>
<h4 id="图片演示"><a href="#图片演示" class="headerlink" title="图片演示"></a>图片演示</h4><p><img src="/images/algorithm/%E6%A1%B6%E6%8E%92%E5%BA%8F.png" alt="桶排序"></p>
<h4 id="算法分析-2"><a href="#算法分析-2" class="headerlink" title="算法分析"></a>算法分析</h4><p>现在假设我有一堆蛋，包括麻雀蛋、鸡蛋、恐龙蛋，现在我要将这几种蛋排序下序；<br>有点常识就知道，这三种类别的蛋大小是不一样的,而且每一类蛋的大小也是有区别的，现在我对这三种蛋进行排序，我是这样排的：<br>准备三个桶，把同一类别的蛋放到同一个桶中，然后对每一个桶内的蛋进行排序，然后按顺序从三个桶中取出相应蛋排序；<br>即，从放有麻雀蛋的桶里取出所有麻雀蛋，因为已经有序，直接取出即可，然后再将鸡蛋取出，最后取出恐龙蛋，排序完成；<br>桶排序即先将大小相近的蛋（或“同一类蛋”）放入到同一个桶中，然后对桶内的蛋进行排序，由于每个桶内蛋的数量比较有限，所以排序效率较高</p>
<p>桶排序是一种时间复杂度为O（n）的排序方法，但并不意味着它有多优秀，上帝打开一扇门的同时也会关上一扇窗<br>桶排序的局限如下：<br>1）桶排序耗用较大的辅助空间，所需要的辅助空间一般与被排序的数列的最大值与最小值有关；<br>2）听到“桶”，很容易联想到哈希表，因为哈希表的冲突解决方法之一开链法也相当于一个个桶,事实上，这两种桶的原理是基本相同的；<br>3）并非所有数列都适合桶排序,桶排序适合分布比较均匀的数列，如1，2，3，6，4，像0，999，558，10000这种就不太适合<br>4）桶排序是一种稳定的排序算法<br>5）桶排序需要维护一个链表，但也有一类简单的桶排序算例如下，所有不同键值是放在不同的桶当中的，所以不用维护链表，当然，下面这种方法也不再稳定</p>
<h4 id="代码实现-8"><a href="#代码实现-8" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">BucketSort</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; vec)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> length = vec.<span class="built_in">size</span>();</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">buckets</span><span class="params">(length, <span class="number">0</span>)</span></span>;<span class="comment">//准备一堆桶，容器的下标即待排序数组的键值或键值经过转化后的值</span></span><br><span class="line">                                   <span class="comment">//此时每个桶中都是没有放蛋的，所以都是0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; length; ++i) &#123;</span><br><span class="line">        buckets[vec[i]]++;<span class="comment">//把每个蛋放入到对应的桶中</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; length; ++i) &#123;<span class="comment">//把蛋取出，空桶则直接跳过</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; buckets[i]; j++) &#123;</span><br><span class="line">            vec[index++] = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="基数排序"><a href="#基数排序" class="headerlink" title="基数排序"></a>基数排序</h3><p>基数排序(Radix Sort)是桶排序的扩展，它的基本思想是：将整数按位数切割成不同的数字，然后按每个位数分别比较。<br>具体做法是：将所有待比较数值统一为同样的数位长度，数位较短的数前面补零。然后，从最低位开始，依次进行一次排序。这样从最低位排序一直到最高位排序完成以后, 数列就变成一个有序序列。</p>
<h4 id="图文说明"><a href="#图文说明" class="headerlink" title="图文说明"></a>图文说明</h4><p>通过基数排序对数组{53, 3, 542, 748, 14, 214, 154, 63, 616}，它的示意图如下：</p>
<p><img src="/images/algorithm/%E5%9F%BA%E6%95%B0%E6%8E%92%E5%BA%8F.png" alt="基数排序"></p>
<p>在上图中，首先将所有待比较树脂统一为统一位数长度，接着从最低位开始，依次进行排序。 </p>
<ol>
<li>按照个位数进行排序。 </li>
<li>按照十位数进行排序。 </li>
<li>按照百位数进行排序。<br>排序后，数列就变成了一个有序序列。</li>
</ol>
<p>为什么要从个数开始比较，低位是有序的，高位中如果有相同的值，则只需在保持稳定的前提下对高位进行排序，结果自然有序</p>
<h4 id="代码实现-9"><a href="#代码实现-9" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//radix sort</span></span><br><span class="line"><span class="comment">//基数排序也是基于一种假设，假设所有数都是非负的整数</span></span><br><span class="line"><span class="comment">//基数排序的基本思路是从低位至高位依次比较每个数的对应位，并排序；对应位的比较采用计数排序也可以采用桶排序；</span></span><br><span class="line"><span class="comment">//基数排序是一种稳定的排序方法，不稳定的话也没法排序，因为某一位相同并不代表两个数相同； </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span> </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">countSort</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; vec,<span class="type">int</span> exp)</span></span></span><br><span class="line"><span class="function"></span>&#123;   <span class="comment">//计数排序</span></span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">range</span><span class="params">(<span class="number">10</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line"> </span><br><span class="line">	<span class="type">int</span> length=vec.<span class="built_in">size</span>();</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">tmpVec</span><span class="params">(length,<span class="number">0</span>)</span></span>;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;length;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		range[(vec[i]/exp)%<span class="number">10</span>]++;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;range.<span class="built_in">size</span>();++i)</span><br><span class="line">	&#123;</span><br><span class="line">		range[i]+=range[i<span class="number">-1</span>];<span class="comment">//统计本应该出现的位置</span></span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=length<span class="number">-1</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line">	&#123;</span><br><span class="line">		tmpVec[range[(vec[i]/exp)%<span class="number">10</span>]<span class="number">-1</span>]=vec[i];</span><br><span class="line">		range[(vec[i]/exp)%<span class="number">10</span>]--;</span><br><span class="line">	&#125;</span><br><span class="line">	vec=tmpVec;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">radixSort</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; vec)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> length=vec.<span class="built_in">size</span>();</span><br><span class="line">	<span class="type">int</span> max=<span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;length;++i)</span><br><span class="line">	&#123;</span><br><span class="line">        <span class="comment">//提取出最大值</span></span><br><span class="line">		<span class="keyword">if</span>(vec[i]&gt;max)</span><br><span class="line">			max=vec[i];</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//提取每一位并进行比较，位数不足的高位补0</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> exp=<span class="number">1</span>;max/exp&gt;<span class="number">0</span>;exp*=<span class="number">10</span>)</span><br><span class="line">		<span class="built_in">countSort</span>(vec,exp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/21d9b983.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="gobert">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="流媒体开发">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/21d9b983.html" class="post-title-link" itemprop="url">WebRTC 发送端无法获取丢包率的解决办法，以及如何获取 rtt</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-05-07 14:49:21" itemprop="dateCreated datePublished" datetime="2019-05-07T14:49:21+08:00">2019-05-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-13 21:26:14" itemprop="dateModified" datetime="2022-02-13T21:26:14+08:00">2022-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/RTC/" itemprop="url" rel="index"><span itemprop="name">RTC</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>WebRTC 自 M68 版本推出新的重载方法 <code>GetStats</code> 以后，使用新的接口便再也获取不到发送端的丢包率了（包括所有的 Native 端和 Web 端），原因是在 <code>void OnStatsDelivered(const rtc::scoped_refptr&lt;const RTCStatsReport&gt;&amp; report)</code> 回调中返回的结构体 <code>RTCStatsReport</code> 中没有 <code>packets_lost</code> 的定义，只有 <code>packets_sent</code>、<code>frames_encoded</code> 等信息，默认只能获取到发送的码率、帧率，而得不到丢包率、rtt 等判断网络质量的关键信息。不过 WebRTC 底层其实已经将丢包信息、rtt 等关键信息实时统计上来了，只是 <code>PeerConnectionInterface</code> 在获取 Statistics 时，没有将相关信息打包进 <code>RTCStatsReport</code> 结构体中，那么解决办法就是：在 <code>RTCStatsReport</code> 结构体中新增定义 <code>packets_lost</code>、<code>rtt_ms</code> 字段，并为其赋值即可，下面为 Native 源码中需要修改的相关代码。</p>
<h2 id="增加-RTCOutboundRTPStreamStats-导出结构体字段定义"><a href="#增加-RTCOutboundRTPStreamStats-导出结构体字段定义" class="headerlink" title="增加 RTCOutboundRTPStreamStats 导出结构体字段定义"></a>增加 <code>RTCOutboundRTPStreamStats</code> 导出结构体字段定义</h2><p>数据发送方数据的统计记录在 Outbound 的结构中，即：<code>RTCOutboundRTPStreamStats</code>，为其在末尾新增两个字段：</p>
<blockquote>
<p>文件为： api&#x2F;stats&#x2F;rtcstats_objects.h </p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">RTCOutboundRTPStreamStats</span> <span class="keyword">final</span> : <span class="keyword">public</span> RTCRTPStreamStats &#123;</span><br><span class="line"> <span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">WEBRTC_RTCSTATS_DECL</span>();</span><br><span class="line"></span><br><span class="line">  <span class="built_in">RTCOutboundRTPStreamStats</span>(<span class="type">const</span> std::string&amp; id, <span class="type">int64_t</span> timestamp_us);</span><br><span class="line">  <span class="built_in">RTCOutboundRTPStreamStats</span>(std::string&amp;&amp; id, <span class="type">int64_t</span> timestamp_us);</span><br><span class="line">  <span class="built_in">RTCOutboundRTPStreamStats</span>(<span class="type">const</span> RTCOutboundRTPStreamStats&amp; other);</span><br><span class="line">  ~<span class="built_in">RTCOutboundRTPStreamStats</span>() <span class="keyword">override</span>;</span><br><span class="line"></span><br><span class="line">  RTCStatsMember&lt;<span class="type">uint32_t</span>&gt; packets_sent;</span><br><span class="line">  RTCStatsMember&lt;<span class="type">uint64_t</span>&gt; bytes_sent;</span><br><span class="line">  <span class="comment">// TODO(hbos): Collect and populate this value. https://bugs.webrtc.org/7066</span></span><br><span class="line">  RTCStatsMember&lt;<span class="type">double</span>&gt; target_bitrate;</span><br><span class="line">  RTCStatsMember&lt;<span class="type">uint32_t</span>&gt; frames_encoded;</span><br><span class="line">    <span class="comment">// 新增字段</span></span><br><span class="line">  RTCStatsMember&lt;<span class="type">int32_t</span>&gt; packets_lost;</span><br><span class="line">  RTCStatsMember&lt;<span class="type">int32_t</span>&gt; rtt_ms;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="初始化新字段"><a href="#初始化新字段" class="headerlink" title="初始化新字段"></a>初始化新字段</h2><blockquote>
<p>文件为：stats&#x2F;rtcstats_objects.cc</p>
</blockquote>
<ul>
<li>构造函数的初始化列表增加 <code>RTCStatsMember</code> 键值对的初始化</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">RTCOutboundRTPStreamStats::<span class="built_in">RTCOutboundRTPStreamStats</span>(</span><br><span class="line">    std::string&amp;&amp; id, <span class="type">int64_t</span> timestamp_us)</span><br><span class="line">    : <span class="built_in">RTCRTPStreamStats</span>(std::<span class="built_in">move</span>(id), timestamp_us),</span><br><span class="line">      <span class="built_in">packets_sent</span>(<span class="string">&quot;packetsSent&quot;</span>),</span><br><span class="line">      <span class="built_in">bytes_sent</span>(<span class="string">&quot;bytesSent&quot;</span>),</span><br><span class="line">      <span class="built_in">target_bitrate</span>(<span class="string">&quot;targetBitrate&quot;</span>),</span><br><span class="line">      <span class="built_in">frames_encoded</span>(<span class="string">&quot;framesEncoded&quot;</span>),</span><br><span class="line">      <span class="built_in">packets_lost</span>(<span class="string">&quot;packetsLost&quot;</span>),</span><br><span class="line">      <span class="built_in">rtt_ms</span>(<span class="string">&quot;rttMs&quot;</span>) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>拷贝构造函数初始化</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">RTCOutboundRTPStreamStats::<span class="built_in">RTCOutboundRTPStreamStats</span>(</span><br><span class="line">    <span class="type">const</span> RTCOutboundRTPStreamStats&amp; other)</span><br><span class="line">    : <span class="built_in">RTCRTPStreamStats</span>(other),</span><br><span class="line">      <span class="built_in">packets_sent</span>(other.packets_sent),</span><br><span class="line">      <span class="built_in">bytes_sent</span>(other.bytes_sent),</span><br><span class="line">      <span class="built_in">target_bitrate</span>(other.target_bitrate),</span><br><span class="line">      <span class="built_in">frames_encoded</span>(other.frames_encoded),</span><br><span class="line">      <span class="built_in">packets_lost</span>(other.packets_lost),</span><br><span class="line">      <span class="built_in">rtt_ms</span>(other.rtt_ms) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>outbound-rtp</code> 中增加 Json 导出字段</li>
</ul>
<blockquote>
<p>如果不增加，在上层 ToJoin 时是没有 <code>packetLost</code> 和 <code>rttMs</code> 字段的。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// clang-format off</span></span><br><span class="line"><span class="built_in">WEBRTC_RTCSTATS_IMPL</span>(</span><br><span class="line">    RTCOutboundRTPStreamStats, RTCRTPStreamStats, <span class="string">&quot;outbound-rtp&quot;</span>,</span><br><span class="line">    &amp;packets_sent,</span><br><span class="line">    &amp;bytes_sent,</span><br><span class="line">    &amp;target_bitrate,</span><br><span class="line">    &amp;frames_encoded,</span><br><span class="line">    &amp;packets_lost,</span><br><span class="line">    &amp;rtt_ms);</span><br><span class="line"><span class="comment">// clang-format on</span></span><br></pre></td></tr></table></figure>

<h2 id="为新字段赋值"><a href="#为新字段赋值" class="headerlink" title="为新字段赋值"></a>为新字段赋值</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Provides the media independent counters (both audio and video).</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SetOutboundRTPStreamStatsFromMediaSenderInfo</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> cricket::MediaSenderInfo&amp; media_sender_info,</span></span></span><br><span class="line"><span class="params"><span class="function">    RTCOutboundRTPStreamStats* outbound_stats)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">RTC_DCHECK</span>(outbound_stats);</span><br><span class="line">  outbound_stats-&gt;ssrc = media_sender_info.<span class="built_in">ssrc</span>();</span><br><span class="line">  <span class="comment">// TODO(hbos): Support the remote case. https://crbug.com/657856</span></span><br><span class="line">  outbound_stats-&gt;is_remote = <span class="literal">false</span>;</span><br><span class="line">  outbound_stats-&gt;packets_sent =</span><br><span class="line">      <span class="built_in">static_cast</span>&lt;<span class="type">uint32_t</span>&gt;(media_sender_info.packets_sent);</span><br><span class="line">  outbound_stats-&gt;bytes_sent =</span><br><span class="line">      <span class="built_in">static_cast</span>&lt;<span class="type">uint64_t</span>&gt;(media_sender_info.bytes_sent);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 为新字段赋值</span></span><br><span class="line">  outbound_stats-&gt;packets_lost =</span><br><span class="line">      <span class="built_in">static_cast</span>&lt;<span class="type">int32_t</span>&gt;(media_sender_info.packets_lost);</span><br><span class="line">  outbound_stats-&gt;rtt_ms =</span><br><span class="line">      <span class="built_in">static_cast</span>&lt;<span class="type">int32_t</span>&gt;(media_sender_info.rtt_ms);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h2><p>通过 <code>PeerConnectionInterface</code> 的 <code>GetStats</code> 获取到的 <code>RTCStatsReport</code> 结构体 转换为 Json 字符串后，可以发现 <code>outbound-rtp</code> 节点中已经有了以上我们新增的 <code>packetsLost</code> 和 <code>rttMs</code> 两个字段。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">    ..... 其它节点请忽略，这里只展示 outbound-rtp</span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;outbound-rtp&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RTCOutboundRTPAudioStream_856432637&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;timestamp&quot;</span><span class="punctuation">:</span> <span class="number">1557220118008000</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;ssrc&quot;</span><span class="punctuation">:</span> <span class="number">856432637</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;isRemote&quot;</span><span class="punctuation">:</span> <span class="keyword">false</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;mediaType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;audio&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;trackId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RTCMediaStreamTrack_sender_2&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;transportId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RTCTransport_audio_1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;codecId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RTCCodec_audio_Outbound_111&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;packetsSent&quot;</span><span class="punctuation">:</span> <span class="number">484</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bytesSent&quot;</span><span class="punctuation">:</span> <span class="number">81000</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;packetsLost&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;rttMs&quot;</span><span class="punctuation">:</span> <span class="number">13</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;outbound-rtp&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RTCOutboundRTPVideoStream_4038037569&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;timestamp&quot;</span><span class="punctuation">:</span> <span class="number">1557220118008000</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;ssrc&quot;</span><span class="punctuation">:</span> <span class="number">4038037569</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;isRemote&quot;</span><span class="punctuation">:</span> <span class="keyword">false</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;mediaType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;video&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;trackId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RTCMediaStreamTrack_sender_1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;transportId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RTCTransport_audio_1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;codecId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RTCCodec_video_Outbound_100&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;firCount&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;pliCount&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;nackCount&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;qpSum&quot;</span><span class="punctuation">:</span> <span class="number">2883</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;packetsSent&quot;</span><span class="punctuation">:</span> <span class="number">559</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bytesSent&quot;</span><span class="punctuation">:</span> <span class="number">579220</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;framesEncoded&quot;</span><span class="punctuation">:</span> <span class="number">145</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;packetsLost&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;rttMs&quot;</span><span class="punctuation">:</span> <span class="number">13</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<p>解析 Json 字符串获取 <code>packetsLost</code> 前后两次的差值，除以时间差便可以获取到此时间段内的丢包率了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/a2661658.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="gobert">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="流媒体开发">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/a2661658.html" class="post-title-link" itemprop="url">webrtc on linux alsa audio device blocking</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-04-16 11:56:05" itemprop="dateCreated datePublished" datetime="2019-04-16T11:56:05+08:00">2019-04-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-13 21:26:14" itemprop="dateModified" datetime="2022-02-13T21:26:14+08:00">2022-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/RTC/" itemprop="url" rel="index"><span itemprop="name">RTC</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>基于 webrtc 开发嵌入式 linux 实时音视频，其中音频 alsa 模块存在一个不小的 Bug，在较多的声卡上存在播放失败并阻塞的严重问题，问题如下：<br>存在大概率的声卡打开失败，即 <code>snd_pcm_prepare</code> 失败的概率，在 源码中 webrtc 会尝试通过 <code>ErrorRecovery</code> 恢复声卡至正确的状态，但是执行到 <code>snd_pcm_recover</code> 输出 <code>underrun occurred</code> 错误信息后便阻塞了。</p>
<p>原因在于 <code>snd_pcm_recover</code> 源码中会调动 <code>snd_pcm_prepare</code> 方法尝试恢复声卡状态，但是 <code>snd_pcm_prepare</code> 会首先获取 <code>snd_pcm_t</code> 中的线程锁 <code>pthread_mutex_t</code>，而 webrtc 在 <code>AudioDeviceLinuxALSA::StartPlayout()</code> 方法中是先启动播放线程，然后再调用 <code>snd_pcm_prepare</code> 准备好声卡设备，导致线程有一定概率启动速度早于父线程中对 <code>snd_pcm_prepare</code> 的调用，最终播放线程中在执行 <code>snd_pcm_avail_update</code> 失败，触发 <code>ErrorRecovery</code> 方法，内部有线程锁，导致线程死锁，整个 APP Blocking；</p>
<p>修复方式比较简单，修改 <code>audio_device_alsa_linux.cc</code> 文件中的 <code>StartPlayout</code> 方法如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int32_t</span> <span class="title">AudioDeviceLinuxALSA::StartPlayout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!_playIsInitialized) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (_playing) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _playing = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">  _playoutFramesLeft = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> (!_playoutBuffer)</span><br><span class="line">    _playoutBuffer = <span class="keyword">new</span> <span class="type">int8_t</span>[_playoutBufferSizeIn10MS];</span><br><span class="line">  <span class="keyword">if</span> (!_playoutBuffer) &#123;</span><br><span class="line">    <span class="built_in">RTC_LOG</span>(LS_ERROR) &lt;&lt; <span class="string">&quot;failed to alloc playout buf&quot;</span>;</span><br><span class="line">    _playing = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> errVal = <span class="built_in">LATE</span>(snd_pcm_prepare)(_handlePlayout);</span><br><span class="line">  <span class="keyword">if</span> (errVal &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">RTC_LOG</span>(LS_ERROR) &lt;&lt; <span class="string">&quot;playout snd_pcm_prepare failed (&quot;</span></span><br><span class="line">                      &lt;&lt; <span class="built_in">LATE</span>(snd_strerror)(errVal) &lt;&lt; <span class="string">&quot;)\n&quot;</span>;</span><br><span class="line">    <span class="comment">// just log error</span></span><br><span class="line">    <span class="comment">// if snd_pcm_open fails will return -1</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 将线程的启动放到 snd_pcm_prepare 之后再启动</span></span><br><span class="line">  <span class="comment">// PLAYOUT</span></span><br><span class="line">  _ptrThreadPlay.<span class="built_in">reset</span>(<span class="keyword">new</span> rtc::<span class="built_in">PlatformThread</span>(</span><br><span class="line">      PlayThreadFunc, <span class="keyword">this</span>, <span class="string">&quot;webrtc_audio_module_play_thread&quot;</span>));</span><br><span class="line">  _ptrThreadPlay-&gt;<span class="built_in">Start</span>();</span><br><span class="line">  _ptrThreadPlay-&gt;<span class="built_in">SetPriority</span>(rtc::kRealtimePriority);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>StartRecording 最好也调整下调用顺序。</strong></p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/3784820804.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="gobert">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="流媒体开发">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/3784820804.html" class="post-title-link" itemprop="url">mediasoup 公网环境部署</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-04-01 23:42:10" itemprop="dateCreated datePublished" datetime="2019-04-01T23:42:10+08:00">2019-04-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-13 21:26:14" itemprop="dateModified" datetime="2022-02-13T21:26:14+08:00">2022-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/RTC/" itemprop="url" rel="index"><span itemprop="name">RTC</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>最近以来一直基于 mediasoup 开发 rtc 相关产品，一直想基于 mediasoup 搭建自己的一套基础的 rtc 环境，用于自己练习 golang、rust 的开发、学习和测试，内网下搭建 mediasoup 比较简单，参照官网的文档一步步来很容易就能搞定，不过如果要在公网下搭建一套环境，相对来说略微麻烦些，需要云主机、nginx 配置、https 配置，通过这篇文章记录上述环境搭建的关键步骤。</p>
<blockquote>
<p>以下操作均在 Ubuntu 18.04 Server 系统上操作。</p>
</blockquote>
<h1 id="准备云主机"><a href="#准备云主机" class="headerlink" title="准备云主机"></a>准备云主机</h1><p>公网环境的搭建还是需要一台拥有公网 IP 的主机的，当然如果你能薅公司的羊毛就更好了 。。本人的是阿里云主机 Ubuntu 系统 16.04 upgrade to 18.04，双11 时买的最便宜的机型，同时安装 ssh、 git、nodejs、npm，开启远程登录。</p>
<h1 id="域名准备"><a href="#域名准备" class="headerlink" title="域名准备"></a>域名准备</h1><p>通过浏览器打开音视频设备因为有安全方面的限制，不能通过 IP 进行访问，必须通过 <a target="_blank" rel="noopener" href="https://domain/">https://domain</a> 的 url 打开，所以我们还需要准备一个域名并解析到我们自己的公网 IP 地址，域名也可以通过阿里云进行购买，因为不需要 seo，所以选一个最便宜的后缀即可，我选择了 <code>gobert.top</code>，第一年只有 9 元，后面还需要域名备案，否则域名将被重定向到指定地址，所以域名需要提前准备。</p>
<blockquote>
<p>首次域名备案相对来说比较麻烦，需要准备居住证（来沪外来人员）等证件，各种审核需要耗时两三天吧。</p>
</blockquote>
<h1 id="安装-mediasoup"><a href="#安装-mediasoup" class="headerlink" title="安装 mediasoup"></a>安装 mediasoup</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">λ ssh gobert@47.100.110.xxx</span><br><span class="line">gobert@47.100.110.xxx&#x27;s password:</span><br><span class="line">Welcome to Ubuntu 18.04.1 LTS (GNU/Linux 4.15.0-38-generic x86_64)</span><br><span class="line"></span><br><span class="line">Last login: Mon Apr  1 17:28:34 2019 from 116.236.177.xxx</span><br><span class="line">$ mkdir develop</span><br><span class="line">$ cd develop</span><br><span class="line">$ git clone git@github.com:versatica/mediasoup-demo.git</span><br></pre></td></tr></table></figure>

<p>后续 npm 的安装需参照 <code>https://github.com/versatica/mediasoup-demo/</code> 文档进行。</p>
<h1 id="nginx-配置"><a href="#nginx-配置" class="headerlink" title="nginx 配置"></a>nginx 配置</h1><blockquote>
<p>这一步默认域名购买、解析、备案已完成。</p>
</blockquote>
<h2 id="在线安装-nginx"><a href="#在线安装-nginx" class="headerlink" title="在线安装 nginx"></a>在线安装 nginx</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install nginx</span><br></pre></td></tr></table></figure>

<h2 id="部署-mediasoup-到-nginx"><a href="#部署-mediasoup-到-nginx" class="headerlink" title="部署 mediasoup 到 nginx"></a>部署 mediasoup 到 nginx</h2><blockquote>
<p>将 mediasoup 中的 server 目录拷贝到 nginx 根目录下。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo mkdir -p /var/www/mediasoup</span><br><span class="line">$ sudo cp -r medissoup-demo/server/ /var/www/mediasoup/</span><br></pre></td></tr></table></figure>

<p>配置 nginx 解析到以上目录，编辑 <code>/etc/nginx/sites-available/default</code> 配置文件，将 server 根路径下的 root 属性修改为 <code>/var/www/mediasoup/server/public;</code>,即：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 以上省略</span><br><span class="line">#root /var/www/html;</span><br><span class="line">root /var/www/mediasoup/server/public;</span><br><span class="line"></span><br><span class="line"># Add index.php to the list if you are using PHP</span><br><span class="line">index index.html index.htm index.nginx-debian.html;</span><br><span class="line"># 以下省略</span><br></pre></td></tr></table></figure>

<h2 id="配置-https-服务"><a href="#配置-https-服务" class="headerlink" title="配置 https 服务"></a>配置 https 服务</h2><p>通过浏览器打开设备需要 https 安全 url，nginx 必须开启 https 服务，通过 letsencrypt 进行 https 的自动化配置，省去了自己很多的麻烦，不用再去申请证书、审核、验证部署等繁琐的操作了，通过 <code>https://certbot.eff.org/lets-encrypt/ubuntubionic-nginx</code> 下的命令按步执行即可。</p>
<p><img src="/images/letsencrypt.png" alt="rtc::Thread UML 类图"></p>
<blockquote>
<p>letsencrpt 安装的 ssl 证书只有三个月的有效期，所以为了防止证书过期，建议添加系统定时任务，定期执行脚本命令更新证书：</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ su -</span><br><span class="line">$ certbot renew --dry-run</span><br></pre></td></tr></table></figure>

<p>正常情况下，你的 nginx 已经开启了 https 服务, ssl 证书及秘钥存放位置记录在 <code>/etc/nginx/sites-available/default</code> 配置文件中，打开 <code>/etc/nginx/sites-available/default</code> 文件，发现 letsencrpty 自动在脚本末尾增加了一项 server 配置，将 <code>root</code> 路径配置为以上 <code>/var/www/mediasoup/server/public;</code> 目录，同时记录下其 ssl_certificate 目录，后面 nginx 配置中需要指定：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">listen [::]:443 ssl ipv6only=on; # managed by Certbot</span><br><span class="line">listen 443 ssl; # managed by Certbot</span><br><span class="line">ssl_certificate /etc/letsencrypt/live/www.gobert.top/fullchain.pem; # managed by Certbot</span><br><span class="line">ssl_certificate_key /etc/letsencrypt/live/www.gobert.top/privkey.pem; # managed by Certbot</span><br><span class="line">include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot</span><br><span class="line">ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot</span><br></pre></td></tr></table></figure>

<h2 id="配置-nginx-开启-gzip"><a href="#配置-nginx-开启-gzip" class="headerlink" title="配置 nginx 开启 gzip"></a>配置 nginx 开启 gzip</h2><p>mediasoup 中 <code>mediasoup-demo-app.js</code> 有 12MB 大小，如果 server 带宽比较低的话，用户首次拉取会比较慢，由于 nginx 默认配置是不开启 gzip 压缩的，所以需要我们手动开启 gzip 压缩，修改 nginx 的配置文件（全站配置）<code>/etc/nginx/nginx.conf</code>，将以下内容的注释全部取消：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">gzip on;</span><br><span class="line"></span><br><span class="line">gzip_vary on;</span><br><span class="line">gzip_proxied any;</span><br><span class="line">gzip_comp_level 6;</span><br><span class="line">gzip_buffers 16 8k;</span><br><span class="line">gzip_http_version 1.1;</span><br><span class="line">gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;</span><br></pre></td></tr></table></figure>

<p>然后重启 nginx 服务即可：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /etc/init.d/nginx reload</span><br></pre></td></tr></table></figure>


<h2 id="配置-mediasoup-server"><a href="#配置-mediasoup-server" class="headerlink" title="配置 mediasoup server"></a>配置 mediasoup server</h2><ul>
<li>配置自定义脚本：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ copy config.example.js config.js</span><br></pre></td></tr></table></figure>

<p>打开 config.js 文件，在 tls 路径中，将上面记录的 letsencrypt 证书路径拷贝到相应的 item 中，同时修改 <code>rtcAnnouncedIPv4</code> 为云主机公网 IP 地址，完整的 config.js 的文件为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">module.exports =</span><br><span class="line">&#123;</span><br><span class="line">        // Listening hostname for `gulp live|open`.</span><br><span class="line">        domain : &#x27;localhost&#x27;,</span><br><span class="line">        tls    :</span><br><span class="line">        &#123;</span><br><span class="line">                cert : `/etc/letsencrypt/live/www.gobert.top/fullchain.pem`, // letsencrypt 证书</span><br><span class="line">                key  : `/etc/letsencrypt/live/www.gobert.top/privkey.pem`    // letsencrypt 秘钥</span><br><span class="line">        &#125;,</span><br><span class="line">        mediasoup :</span><br><span class="line">        &#123;</span><br><span class="line">                // mediasoup Server settings.</span><br><span class="line">                logLevel : &#x27;warn&#x27;,</span><br><span class="line">                logTags  :</span><br><span class="line">                [</span><br><span class="line">                        &#x27;info&#x27;,</span><br><span class="line">                        &#x27;ice&#x27;,</span><br><span class="line">                        &#x27;dtls&#x27;,</span><br><span class="line">                        &#x27;rtp&#x27;,</span><br><span class="line">                        &#x27;srtp&#x27;,</span><br><span class="line">                        &#x27;rtcp&#x27;,</span><br><span class="line">                        // &#x27;rbe&#x27;,</span><br><span class="line">                        // &#x27;rtx&#x27;</span><br><span class="line">                ],</span><br><span class="line">                numWorkers       : null, // Use number of CPUs.</span><br><span class="line">                rtcIPv4          : true,</span><br><span class="line">                rtcIPv6          : true,</span><br><span class="line">                rtcAnnouncedIPv4 : &#x27;47.100.110.192&#x27;, // 云主机公网地址</span><br><span class="line">                rtcAnnouncedIPv6 : null,  // 根据需要，自主填写</span><br><span class="line">                rtcMinPort       : 40000, // udp 最小端口，需要云主机安全组中配置</span><br><span class="line">                rtcMaxPort       : 49999, // dup 最大端口，需要云主机安全组中配置</span><br><span class="line">                // mediasoup Room codecs.</span><br><span class="line">                mediaCodecs      :</span><br><span class="line">                [</span><br><span class="line">                        &#123;</span><br><span class="line">                                kind       : &#x27;audio&#x27;,</span><br><span class="line">                                name       : &#x27;opus&#x27;,</span><br><span class="line">                                mimeType   : &#x27;audio/opus&#x27;,</span><br><span class="line">                                clockRate  : 48000,</span><br><span class="line">                                channels   : 2,</span><br><span class="line">                                parameters :</span><br><span class="line">                                &#123;</span><br><span class="line">                                        useinbandfec : 1</span><br><span class="line">                                &#125;</span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                                kind       : &#x27;video&#x27;,</span><br><span class="line">                                name       : &#x27;VP8&#x27;,</span><br><span class="line">                                mimeType   : &#x27;video/VP8&#x27;,</span><br><span class="line">                                clockRate  : 90000,</span><br><span class="line">                                parameters :</span><br><span class="line">                                &#123;</span><br><span class="line">                                        &#x27;x-google-start-bitrate&#x27;: 1500</span><br><span class="line">                                &#125;</span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                                kind       : &#x27;video&#x27;,</span><br><span class="line">                                name       : &#x27;h264&#x27;,</span><br><span class="line">                                mimeType   : &#x27;video/h264&#x27;,</span><br><span class="line">                                clockRate  : 90000,</span><br><span class="line">                                parameters :</span><br><span class="line">                                &#123;</span><br><span class="line">                                        &#x27;packetization-mode&#x27;      : 1,</span><br><span class="line">                                        &#x27;profile-level-id&#x27;        : &#x27;42e01f&#x27;,</span><br><span class="line">                                        &#x27;level-asymmetry-allowed&#x27; : 1</span><br><span class="line">                                &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                ],</span><br><span class="line">                // mediasoup per Peer max sending bitrate (in bps).</span><br><span class="line">                maxBitrate : 500000</span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li>修改 Server 监听端口</li>
</ul>
<blockquote>
<p>此处修改 server 的监听端口其实没什么意义，可以忽略。</p>
</blockquote>
<p>编辑 <code>server.js</code> 配置文件，将默认端口 <code>httpsServer.listen(3443, &#39;0.0.0.0&#39;, () =&gt;</code> 替换为 <code>httpsServer.listen(5678, &#39;0.0.0.0&#39;, () =&gt;</code>。</p>
<ul>
<li>配置 Client 访问 Server WSS 地址</li>
</ul>
<p>打开 <code> public/mediasoup-demo-app.js</code> 将 <code>getProtooUrl</code> 方法中的 URL 地址端口改为自定义的 <code>5678</code> 端口：</p>
<blockquote>
<p>如果上一步中没有修改 server 的监听端口的话，这一步也可忽略。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function getProtooUrl(peerName, roomId, forceH264) &#123;</span><br><span class="line">  var hostname = window.location.hostname;</span><br><span class="line">  var url = &quot;wss://&quot;.concat(hostname, &quot;:5678/?peerName=&quot;).concat(peerName, &quot;&amp;roomId=&quot;).concat(roomId);</span><br><span class="line">  if (forceH264) url = &quot;&quot;.concat(url, &quot;&amp;forceH264=true&quot;);</span><br><span class="line">  return url;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="启动-mediasoup-server"><a href="#启动-mediasoup-server" class="headerlink" title="启动 mediasoup server"></a>启动 mediasoup server</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd /var/www/mediasoup/server</span><br><span class="line">$ sudo DEBUG=&quot;*mediasoup* *ERROR* *WARN*&quot; INTERACTIVE=&quot;true&quot; node server.js</span><br></pre></td></tr></table></figure>

<h2 id="重启-nginx"><a href="#重启-nginx" class="headerlink" title="重启 nginx"></a>重启 nginx</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo nginx -s reload</span><br></pre></td></tr></table></figure>
<h1 id="在线体验"><a href="#在线体验" class="headerlink" title="在线体验"></a>在线体验</h1><blockquote>
<p>此主机带宽比较低，初次打开比较慢，需耐心等待加载完成，后面缓冲后速度会变化，音视频延迟不受影响。</p>
</blockquote>
<p>在两个终端浏览器（支持 Chrome、Firefox、Safari）中均打开 <code>https://www.gobert.top/?roomId=123456</code> 即可体验，RoomId 可自定义，效果图：</p>
<p><img src="/images/mediasoup-brower.png" alt="连麦效果图"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/239554791.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="gobert">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="流媒体开发">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/239554791.html" class="post-title-link" itemprop="url">2019-目标</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-01-23 22:37:46" itemprop="dateCreated datePublished" datetime="2019-01-23T22:37:46+08:00">2019-01-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-13 21:26:14" itemprop="dateModified" datetime="2022-02-13T21:26:14+08:00">2022-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Life/" itemprop="url" rel="index"><span itemprop="name">Life</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>给自己制定一个 2019 年的目标，2018 年给自己制定的任务完成的很不好，在此立个 Flag，2019 年务实不务虚，拓宽自己未来的道路。</p>
<h2 id="阅读"><a href="#阅读" class="headerlink" title="阅读"></a>阅读</h2><ul>
<li>阅读 5 本专业以外的书籍</li>
<li>将京东上已购的情商方面的书籍读完</li>
<li>阅读一本可提高自己视野和创新性的书籍</li>
</ul>
<h2 id="专业技能"><a href="#专业技能" class="headerlink" title="专业技能"></a>专业技能</h2><ul>
<li>提高自己英语听、说、读、写能力，打破这种限制自己继续前进的障碍</li>
<li>在流媒体圈子中打造个人品牌！！！</li>
</ul>
<h2 id="财务目标"><a href="#财务目标" class="headerlink" title="财务目标"></a>财务目标</h2><ul>
<li>突破只有薪资一种收入来源的困境，创造一种工资以外的稳定收入来源，为实现财务自由而努力。</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/3440048822.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="gobert">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="流媒体开发">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/3440048822.html" class="post-title-link" itemprop="url">Linux 基于 webrtc 进行流媒体开发</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-01-23 10:56:31" itemprop="dateCreated datePublished" datetime="2019-01-23T10:56:31+08:00">2019-01-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-13 21:26:14" itemprop="dateModified" datetime="2022-02-13T21:26:14+08:00">2022-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/RTC/" itemprop="url" rel="index"><span itemprop="name">RTC</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在 Linux 平台下开发实时通话 SDK 其实是主要应用于未来的 IOT 行业，先基于 Ubuntu 作为开发平台，完成后再基于每个客户提供的其交叉编译工具链进行交叉编译以供用户使用。</p>
<h2 id="基于-Ubuntu-下载-webrtc"><a href="#基于-Ubuntu-下载-webrtc" class="headerlink" title="基于 Ubuntu 下载 webrtc"></a>基于 Ubuntu 下载 webrtc</h2><h3 id="自行下载编译"><a href="#自行下载编译" class="headerlink" title="自行下载编译"></a>自行下载编译</h3><p>如果是自己下载编译的话，可以参考官方教程，或者参考本人之前的一篇博客： <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/09f065f3feb0">https://www.jianshu.com/p/09f065f3feb0</a> ，其实 Ubuntu 下编译 webrtc 是比较简单的，只要可以翻墙，其它都只是时间问题了。</p>
<h3 id="无法翻墙下载"><a href="#无法翻墙下载" class="headerlink" title="无法翻墙下载"></a>无法翻墙下载</h3><p>那么可以通过下载本人配置的一个 Docker 镜像进行进行编译： <a target="_blank" rel="noopener" href="https://hub.docker.com/r/cgb0210/ubuntu_build">https://hub.docker.com/r/cgb0210/ubuntu_build</a> ，由于 Docker 不适合作为开发环境，下载后，建议用户将 develop 目录下的文件拷贝到自己的开发环境中，并参考 <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/09f065f3feb0">https://www.jianshu.com/p/09f065f3feb0</a> 配置相关环境变量，实现本地编译,过程主要包含 3 步：</p>
<h3 id="配置-depot-tools-环境变量"><a href="#配置-depot-tools-环境变量" class="headerlink" title="配置 depot_tools 环境变量"></a>配置 depot_tools 环境变量</h3><p>将 <code>export PATH=$PATH:/home/gobert/develop/depot_tools</code> 添加到 <code>/etc/profile</code> 文件尾部；</p>
<h3 id="安装-GoLang-并配置环境"><a href="#安装-GoLang-并配置环境" class="headerlink" title="安装 GoLang 并配置环境"></a>安装 GoLang 并配置环境</h3><h3 id="安装-Linux-依赖包"><a href="#安装-Linux-依赖包" class="headerlink" title="安装 Linux 依赖包"></a>安装 Linux 依赖包</h3><p>执行 webrtc 目录下的 <code>/build/install-build-deps.sh</code> 脚本命令，如： <code>sudo sh build/install-build-deps.sh</code>；</p>
<h2 id="编译-webrtc"><a href="#编译-webrtc" class="headerlink" title="编译 webrtc"></a>编译 webrtc</h2><p>默认情况下，Linux 下基于 ninja 编译的话，其编译器使用的是 clang，且其依赖的 stdc 标准库为其 .&#x2F;buildtools&#x2F;third_party&#x2F;libc++ 内置的，所以如果外部想要基于 clang 编译的 libwebrtc.a 进行开发的话，上层依然需要使用 clang 做为编译器，且链接 webrtc 内部的 libc++ 标准库，否则将会产生各种 <code>error: undefined reference to symbol ...</code>，无法解决，虽然 clang 比 g++ 要优秀很多，但本人目前还是习惯使用 g++ 进行开发，所以需要指定 g++ 编译器，同时需要注意以下事项：</p>
<h3 id="RTTI-（Run-Time-Type-Identification-运行时类型识别）"><a href="#RTTI-（Run-Time-Type-Identification-运行时类型识别）" class="headerlink" title="RTTI （Run-Time Type Identification 运行时类型识别）"></a>RTTI （Run-Time Type Identification 运行时类型识别）</h3><p>webrtc 内部各模块配置了不同的 rtti 属性，开、关各不相同，默认情况下，加载 libwebrtc.a 会产生 <code>undefined reference to </code>typeinfo for [classname]’<code>错误，为此我们可以在链接 libwebrtc.a 的根编译脚本文件中配置统一去除 rtti 属性，以解决此类问题，打开根目录下的 BUILD.gn 文件，在</code>rtc_static_library(“webrtc”)<code>尾部添加</code>cflags_cc &#x3D; [“ -fno-rtti” ]&#96; 即可，如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if (!build_with_chromium) &#123;</span><br><span class="line"># Target to build all the WebRTC production code.</span><br><span class="line">rtc_static_library(&quot;webrtc&quot;) &#123;</span><br><span class="line">    </span><br><span class="line">    ...</span><br><span class="line">    </span><br><span class="line">    cflags_cc = [&quot; -fno-rtti&quot; ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样便可以解决所有 undefined reference to <code>typeinfo for [classname]&#39;</code> 类的错误。</p>
<h3 id="找不到-builtin-audio-decoder-factory-模块的所有符号"><a href="#找不到-builtin-audio-decoder-factory-模块的所有符号" class="headerlink" title="找不到 builtin_audio_decoder_factory 模块的所有符号"></a>找不到 builtin_audio_decoder_factory 模块的所有符号</h3><p>这应该是 webrtc branch：68 版本的 bug，在各平台均会出现此类问题，原因在于其在编译脚本中漏写了 <code>builtin_audio_decoder_factory</code> 模块，加上即可，打开 <code>audio/BUILD.gn</code> 文件，在 <code>&quot;../api/audio_codecs:builtin_audio_encoder_factory&quot;,</code> 下面添加一行 <code>&quot;../api/audio_codecs:builtin_audio_decoder_factory&quot;,</code> 即可。</p>
<h3 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h3><p>编译命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gn gen -C out/linux/Release  --args=&quot;is_debug=false target_cpu=\&quot;x64\&quot; rtc_include_tests=false rtc_use_h264=true rtc_initialize_ffmpeg=true ffmpeg_branding=\&quot;Chrome\&quot; is_component_build=false is_clang=false treat_warnings_as_errors=false use_custom_libcxx=false strip_debug_info=true use_rtti=false&quot;</span><br></pre></td></tr></table></figure>
<p>其中 <code>rtc_include_tests=false</code> 为禁止编译单元测试程序，可大大节省编译时间；<br><code>rtc_use_h264=true rtc_initialize_ffmpeg=true ffmpeg_branding=\&quot;Chrome\&quot;</code> 为激活内部 H.264 编解码器。</p>
<h2 id="Demo-程序"><a href="#Demo-程序" class="headerlink" title="Demo 程序"></a>Demo 程序</h2><h3 id="编译测试程序加载并调用-webrtc-接口。"><a href="#编译测试程序加载并调用-webrtc-接口。" class="headerlink" title="编译测试程序加载并调用 webrtc 接口。"></a>编译测试程序加载并调用 webrtc 接口。</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;api/jsep.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> webrtc;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    SdpParseError error;</span><br><span class="line">    <span class="keyword">auto</span> ptr = <span class="built_in">CreateSessionDescription</span>(<span class="string">&quot;offer&quot;</span>, <span class="string">&quot;sdp&quot;</span>, &amp;error);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!ptr) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;CreateSessionDescription return null, error str:%s\n&quot;</span>, error.description.<span class="built_in">c_str</span>());</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;CreateSessionDescription success!\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="编写-CMakeLists-txt-脚本文件"><a href="#编写-CMakeLists-txt-脚本文件" class="headerlink" title="编写 CMakeLists.txt 脚本文件"></a>编写 CMakeLists.txt 脚本文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">cmake_minimum_required(VERSION 3.5)</span><br><span class="line">project(demo)</span><br><span class="line"></span><br><span class="line">set(CMAKE_POSITION_INDEPENDENT_CODE     TRUE)</span><br><span class="line"></span><br><span class="line">set(CMAKE_C_FLAGS               &quot;$&#123;CMAKE_C_FLAGS&#125;&quot;)</span><br><span class="line">SET(CMAKE_CXX_FLAGS             &quot;$&#123;CMAKE_CXX_FLAGS&#125; -fno-exceptions -fPIC&quot;)</span><br><span class="line">set(CMAKE_SHARED_LINKER_FLAGS   &quot;$&#123;CMAKE_SHARED_LINKER_FLAGS&#125;&quot;)</span><br><span class="line">set(CMAKE_EXE_LINKER_FLAGS      &quot;$&#123;CMAKE_EXE_LINKER_FLAGS&#125;&quot;)</span><br><span class="line"></span><br><span class="line">set(ARCH_PATH linux)</span><br><span class="line">set(WEBRTC_PATH &quot;/home/gobert/develop/webrtc/src&quot;)</span><br><span class="line">set(WEBRTC_LIBRARY_PATH &quot;/home/gobert/develop/webrtc/src/out/Linux/Release/obj&quot;)</span><br><span class="line"></span><br><span class="line">add_definitions(</span><br><span class="line">    &quot;-DWEBRTC_POSIX&quot;</span><br><span class="line">    &quot;-DWEBRTC_LINUX&quot;</span><br><span class="line">    &quot;-DUSE_GLIB=1&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">if (Linux)</span><br><span class="line">set(ARCH_PATH linux)</span><br><span class="line">elseif (Arm)</span><br><span class="line">set(ARCH_PATH arm)</span><br><span class="line">endif ()</span><br><span class="line"></span><br><span class="line">include_directories(</span><br><span class="line">    $&#123;WEBRTC_PATH&#125;</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">set(SOURCE_FILES</span><br><span class="line">    main.cpp</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">link_directories(</span><br><span class="line">    $&#123;link_directories&#125;</span><br><span class="line">    $&#123;WEBRTC_PATH&#125;/out/Linux/Release/obj</span><br><span class="line">    /usr/lib/x86_64-linux-gnu/</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">link_libraries(</span><br><span class="line">    &quot;$&#123;WEBRTC_LIBRARY_PATH&#125;/libwebrtc.a&quot;</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">add_executable(demo $&#123;SOURCE_FILES&#125;)</span><br><span class="line"></span><br><span class="line">TARGET_LINK_LIBRARIES(demo pthread stdc++)</span><br><span class="line"></span><br><span class="line">set_target_properties(demo PROPERTIES OUTPUT_NAME &quot;demo&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="编译-1"><a href="#编译-1" class="headerlink" title="编译"></a>编译</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake &amp;&amp; make</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/1837193558.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="gobert">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="流媒体开发">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/1837193558.html" class="post-title-link" itemprop="url">Android AEC 无效的解决方案</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-01-23 10:12:21" itemprop="dateCreated datePublished" datetime="2019-01-23T10:12:21+08:00">2019-01-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-13 21:26:14" itemprop="dateModified" datetime="2022-02-13T21:26:14+08:00">2022-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/RTC/" itemprop="url" rel="index"><span itemprop="name">RTC</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Android 端回声消除模块在某些机型上面需要使用 16kHz 的采样率输入，否则将会产生回声问题，为此设计此特殊机型下发服务，在 Android 端启动时查询其是否在此特殊名单中，是则强制为 16kHz 采样率，否则使用默认的 48&#x2F;44.1 kHz 采样率。</p>
<p>因为只有部分机型才会出现此类问题，并且会不断产生新的机型出现，如果在代码中写 HardCode，那么产品的发布将会很被动，因为随时可能会有新的问题机型产生，为此开发一套特殊机型下发的服务，在 APP 启动时向此服务发起请求，校验此机型是否需要配置为 16KHz，然后再启动 RTC 进行音视频通话。此服务通过 Go 进行开发。</p>
<p>GitHub 地址为 ：<a target="_blank" rel="noopener" href="https://github.com/zzlc/rtc-aecm-android">https://github.com/zzlc/rtc-aecm-android</a></p>
<h2 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h2><p>启动命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go run main.go -addr=&quot;127.0.0.1:6688&quot; -prefix=&quot;/v1/aecm/&quot; -user=&quot;root&quot; -password=&quot;123456&quot;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>实际部署后根据实际目标名称进行启动，但启动参数不变，可通过 -h 查看帮助。</p>
</blockquote>
<h2 id="Android-端查询接口"><a href="#Android-端查询接口" class="headerlink" title="Android 端查询接口"></a>Android 端查询接口</h2><p>API 查询接口提供两种，一是查询指定 <code>Model</code> 是否存在于此白名单列表中，二是查询所有的白名单列表；</p>
<h3 id="1、查询指定-Model"><a href="#1、查询指定-Model" class="headerlink" title="1、查询指定 Model"></a>1、查询指定 <code>Model</code></h3><blockquote>
<p>这里及以后均假设 SEV_ADDR 即为 服务器地址。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Request Url:</span><br><span class="line">SEV_ADDR/v1/aecm</span><br><span class="line">Method: OPTIONS</span><br><span class="line"></span><br><span class="line">Request Headers:</span><br><span class="line">model=xxx</span><br><span class="line"></span><br><span class="line">Result:</span><br><span class="line">200 ok</span><br></pre></td></tr></table></figure>


<blockquote>
<p>通过返回 http status 判断 xxx 是否在白名单中，200 为是，否则为 否。</p>
</blockquote>
<h3 id="2、查询所有白名单"><a href="#2、查询所有白名单" class="headerlink" title="2、查询所有白名单"></a>2、查询所有白名单</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Request Url:</span><br><span class="line">SEV_ADDR/v1/aecm</span><br><span class="line">Method: QUERY</span><br><span class="line"></span><br><span class="line">Result:</span><br><span class="line">200 ok</span><br><span class="line">Content type: text/json</span><br><span class="line">body: json string</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果返回 200 ok，则说明查询成功，可通过 content body 的 json string 进行解析，格式如下：</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;7&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gobert&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;brand&quot;</span><span class="punctuation">:</span> <span class="string">&quot;postman_brand&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;insertTime&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2019-01-10 15:19:37&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;redmi_note4&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;osVersion&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Android 6.2&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;packageName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;com.org.xxx&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;sdkVersion&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.0.0&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;8&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gobert&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;brand&quot;</span><span class="punctuation">:</span> <span class="string">&quot;postman_brand&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;insertTime&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2019-01-10 15:19:39&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;redmi_note4&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;osVersion&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Android 6.2&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;packageName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;com.org.xxx&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;sdkVersion&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.0.0&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>


<h2 id="添加新机型"><a href="#添加新机型" class="headerlink" title="添加新机型"></a>添加新机型</h2><p>通过以下 API 即可添加</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Request Url:</span><br><span class="line">SEV_ADDR/v1/aecm</span><br><span class="line">Method: ADD</span><br><span class="line"></span><br><span class="line">Request Headers:</span><br><span class="line">osVersion=Android 6.2</span><br><span class="line">brand=postman_brand</span><br><span class="line">model=xxx</span><br><span class="line">sdkVersion=1.0.0</span><br><span class="line">packageName=com.org.xxx</span><br><span class="line">author=gobert</span><br><span class="line"></span><br><span class="line">Result:</span><br><span class="line">200 ok</span><br></pre></td></tr></table></figure>


<h2 id="删除已有机型"><a href="#删除已有机型" class="headerlink" title="删除已有机型"></a>删除已有机型</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Request Url:</span><br><span class="line">SEV_ADDR/v1/aecm</span><br><span class="line">Method:DELETE</span><br><span class="line"></span><br><span class="line">Request Headers:</span><br><span class="line">model=xxx</span><br><span class="line"></span><br><span class="line">Result:</span><br><span class="line">200 ok</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="gobert"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">gobert</p>
  <div class="site-description" itemprop="description"></div>
</div>
  <div class="sidebar-button motion-element"><i class="fa fa-comment"></i>
    Chat
  </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/gobertcpp" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;gobertcpp" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:18621626807@163.com;chengaobao@gmail.com" title="E-Mail → mailto:18621626807@163.com;chengaobao@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.qnrtc.com/" title="https:&#x2F;&#x2F;www.qnrtc.com" rel="noopener" target="_blank">Title</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2018 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">gobert</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>















  

  

</body>
</html>
